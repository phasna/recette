# ğŸ½ï¸ MCD COMPLET avec Authentification

## ğŸ“Š DIAGRAMME MCD (ModÃ¨le Conceptuel de DonnÃ©es) COMPLET

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                MCD - APPLICATION RECETTES AVEC AUTH            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      USER       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ username        â”‚
â”‚ email           â”‚
â”‚ password        â”‚
â”‚ first_name      â”‚
â”‚ last_name       â”‚
â”‚ country         â”‚
â”‚ avatar_url      â”‚
â”‚ is_active       â”‚
â”‚ email_verified  â”‚
â”‚ created_at      â”‚
â”‚ updated_at      â”‚
â”‚ last_login      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1
         â”‚
         â”‚ 0,N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     RECIPE      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ title           â”‚
â”‚ description     â”‚
â”‚ ingredients     â”‚
â”‚ instructions    â”‚
â”‚ prep_time       â”‚
â”‚ cook_time       â”‚
â”‚ servings        â”‚
â”‚ difficulty      â”‚
â”‚ image_url       â”‚
â”‚ video_url       â”‚
â”‚ user_id (FK)    â”‚
â”‚ is_shared       â”‚
â”‚ share_message   â”‚
â”‚ allow_comments  â”‚
â”‚ show_author_infoâ”‚
â”‚ shared_at       â”‚
â”‚ created_at      â”‚
â”‚ updated_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1
         â”‚
         â”‚ 0,N
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    FAVORITE     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ recipe_id (FK)  â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    COMMENT      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ recipe_id (FK)  â”‚
â”‚ content         â”‚
â”‚ is_approved     â”‚
â”‚ created_at      â”‚
â”‚ updated_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     FOLLOW      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ follower_id (FK)â”‚
â”‚ following_id (FK)â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     BADGE       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ name            â”‚
â”‚ description     â”‚
â”‚ icon            â”‚
â”‚ criteria        â”‚
â”‚ points          â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER_BADGES    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ badge_id (FK)   â”‚
â”‚ earned_at       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PASSWORD_RESET  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ token           â”‚
â”‚ expires_at      â”‚
â”‚ used            â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EMAIL_VERIFICATIONâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ token           â”‚
â”‚ expires_at      â”‚
â”‚ verified        â”‚
â”‚ created_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER_SESSIONS   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ user_id (FK)    â”‚
â”‚ token           â”‚
â”‚ device_info     â”‚
â”‚ ip_address      â”‚
â”‚ expires_at      â”‚
â”‚ created_at      â”‚
â”‚ last_activity   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RECIPE_VIEWS    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ recipe_id (FK)  â”‚
â”‚ user_id (FK)    â”‚
â”‚ ip_address      â”‚
â”‚ viewed_at       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RECIPE_RATINGS  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚
â”‚ recipe_id (FK)  â”‚
â”‚ user_id (FK)    â”‚
â”‚ rating          â”‚
â”‚ review          â”‚
â”‚ created_at      â”‚
â”‚ updated_at      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”— RELATIONS ENTRE ENTITÃ‰S

```
USER (1,N) â”€â”€â”€â”€ RECIPE
  â”‚                â”‚
  â”‚                â”‚
  â”‚ (1,N)          â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
FAVORITE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

USER (1,N) â”€â”€â”€â”€ COMMENT
  â”‚                â”‚
  â”‚                â”‚
  â”‚                â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RECIPE

USER (1,N) â”€â”€â”€â”€ FOLLOW
  â”‚                â”‚
  â”‚ (1,N)          â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ USER

USER (1,N) â”€â”€â”€â”€ USER_BADGES
  â”‚                â”‚
  â”‚                â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BADGE

USER (1,N) â”€â”€â”€â”€ PASSWORD_RESET
  â”‚
  â”‚ (1,N)
  â”‚
  â”‚
USER (1,N) â”€â”€â”€â”€ EMAIL_VERIFICATION

USER (1,N) â”€â”€â”€â”€ USER_SESSIONS

USER (1,N) â”€â”€â”€â”€ RECIPE_VIEWS
  â”‚                â”‚
  â”‚                â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RECIPE

USER (1,N) â”€â”€â”€â”€ RECIPE_RATINGS
  â”‚                â”‚
  â”‚                â”‚ (1,N)
  â”‚                â”‚
  â”‚                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RECIPE
```

## ğŸ“‹ CARDINALITÃ‰S DÃ‰TAILLÃ‰ES

### **USER â†” RECIPE**
- **1 User** peut crÃ©er **0,N Recipes**
- **1 Recipe** appartient Ã  **1 User**
- **Relation** : Composition (User possÃ¨de Recipe)

### **USER â†” FAVORITE**
- **1 User** peut avoir **0,N Favorites**
- **1 Favorite** appartient Ã  **1 User**
- **Relation** : Association (User a des favoris)

### **RECIPE â†” FAVORITE**
- **1 Recipe** peut Ãªtre **0,N Favorites**
- **1 Favorite** concerne **1 Recipe**
- **Relation** : Association (Recipe peut Ãªtre favori)

### **USER â†” COMMENT**
- **1 User** peut Ã©crire **0,N Comments**
- **1 Comment** est Ã©crit par **1 User**
- **Relation** : Association (User Ã©crit des commentaires)

### **RECIPE â†” COMMENT**
- **1 Recipe** peut avoir **0,N Comments**
- **1 Comment** concerne **1 Recipe**
- **Relation** : Association (Recipe a des commentaires)

### **USER â†” FOLLOW**
- **1 User** peut suivre **0,N Users** (following_id)
- **1 User** peut Ãªtre suivi par **0,N Users** (follower_id)
- **Relation** : Association rÃ©flexive (User suit User)

### **USER â†” BADGE (via USER_BADGES)**
- **1 User** peut avoir **0,N Badges**
- **1 Badge** peut Ãªtre attribuÃ© Ã  **0,N Users**
- **Relation** : Association (User a des badges)

### **USER â†” PASSWORD_RESET**
- **1 User** peut avoir **0,N Password_Reset**
- **1 Password_Reset** appartient Ã  **1 User**
- **Relation** : Association (User a des demandes de reset)

### **USER â†” EMAIL_VERIFICATION**
- **1 User** peut avoir **0,N Email_Verification**
- **1 Email_Verification** appartient Ã  **1 User**
- **Relation** : Association (User a des vÃ©rifications email)

### **USER â†” USER_SESSIONS**
- **1 User** peut avoir **0,N User_Sessions**
- **1 User_Session** appartient Ã  **1 User**
- **Relation** : Association (User a des sessions)

### **USER â†” RECIPE_VIEWS**
- **1 User** peut avoir **0,N Recipe_Views**
- **1 Recipe_View** appartient Ã  **1 User**
- **Relation** : Association (User a des vues de recettes)

### **RECIPE â†” RECIPE_VIEWS**
- **1 Recipe** peut avoir **0,N Recipe_Views**
- **1 Recipe_View** concerne **1 Recipe**
- **Relation** : Association (Recipe a des vues)

### **USER â†” RECIPE_RATINGS**
- **1 User** peut avoir **0,N Recipe_Ratings**
- **1 Recipe_Rating** appartient Ã  **1 User**
- **Relation** : Association (User a des notes)

### **RECIPE â†” RECIPE_RATINGS**
- **1 Recipe** peut avoir **0,N Recipe_Ratings**
- **1 Recipe_Rating** concerne **1 Recipe**
- **Relation** : Association (Recipe a des notes)

## ğŸ¯ RÃˆGLES MÃ‰TIER

### **RÃ¨gles d'Authentification**
1. **Un utilisateur** doit avoir un username unique
2. **Un utilisateur** doit avoir un email unique
3. **Un utilisateur** doit avoir un mot de passe hashÃ©
4. **Un utilisateur** peut Ãªtre actif ou inactif
5. **Un utilisateur** peut avoir son email vÃ©rifiÃ© ou non
6. **Un utilisateur** peut avoir plusieurs sessions actives
7. **Un token de reset** expire aprÃ¨s 24h
8. **Un token de vÃ©rification** expire aprÃ¨s 48h

### **RÃ¨gles de Gestion des Recettes**
1. **Une recette** doit avoir un titre non vide
2. **Une recette** doit avoir des ingrÃ©dients
3. **Une recette** doit avoir des instructions
4. **Une recette** peut Ãªtre partagÃ©e publiquement
5. **Une recette** peut autoriser les commentaires
6. **Une recette** peut afficher les infos de l'auteur

### **RÃ¨gles de Gestion des Favoris**
1. **Un utilisateur** ne peut pas mettre la mÃªme recette en favori plusieurs fois
2. **Un favori** est unique par couple (user_id, recipe_id)

### **RÃ¨gles de Gestion des Commentaires**
1. **Un commentaire** ne peut pas Ãªtre vide
2. **Un commentaire** peut Ãªtre approuvÃ© ou non
3. **Un utilisateur** peut modifier ses propres commentaires

### **RÃ¨gles de Gestion des Notes**
1. **Une note** doit Ãªtre entre 1 et 5
2. **Un utilisateur** ne peut noter une recette qu'une seule fois
3. **Un utilisateur** peut modifier sa note

### **Contraintes d'IntÃ©gritÃ©**
1. **ClÃ©s primaires** : Uniques et non nulles
2. **ClÃ©s Ã©trangÃ¨res** : RÃ©fÃ©rences valides
3. **Cascade** : Suppression d'un User â†’ suppression de ses Recipes, Comments, Favorites
4. **Cascade** : Suppression d'une Recipe â†’ suppression de ses Comments, Favorites, Views, Ratings
5. **Cascade** : Suppression d'un User â†’ suppression de ses Sessions, Password_Reset, Email_Verification

## ğŸ“Š DICTIONNAIRE DE DONNÃ‰ES COMPLET

### **USER**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| username | VARCHAR(50) | UNIQUE, NOT NULL | Nom d'utilisateur |
| email | VARCHAR(100) | UNIQUE, NOT NULL | Adresse email |
| password | VARCHAR(255) | NOT NULL | Mot de passe hashÃ© |
| first_name | VARCHAR(50) | NULL | PrÃ©nom |
| last_name | VARCHAR(50) | NULL | Nom de famille |
| country | VARCHAR(50) | NULL | Pays |
| avatar_url | VARCHAR(500) | NULL | URL de l'avatar |
| is_active | BOOLEAN | DEFAULT 1 | Compte actif |
| email_verified | BOOLEAN | DEFAULT 0 | Email vÃ©rifiÃ© |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |
| updated_at | DATETIME | NULL | Date de modification |
| last_login | DATETIME | NULL | DerniÃ¨re connexion |

### **RECIPE**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| title | VARCHAR(255) | NOT NULL | Titre de la recette |
| description | TEXT | NULL | Description |
| ingredients | TEXT | NOT NULL | IngrÃ©dients |
| instructions | TEXT | NOT NULL | Instructions |
| prep_time | INT | NULL | Temps de prÃ©paration (min) |
| cook_time | INT | NULL | Temps de cuisson (min) |
| servings | INT | NULL | Nombre de portions |
| difficulty | ENUM | NULL | Niveau de difficultÃ© |
| image_url | VARCHAR(500) | NULL | URL de l'image |
| video_url | VARCHAR(500) | NULL | URL de la vidÃ©o |
| user_id | INT | FK, NOT NULL | ID de l'utilisateur |
| is_shared | BOOLEAN | DEFAULT 0 | PartagÃ© publiquement |
| share_message | TEXT | NULL | Message de partage |
| allow_comments | BOOLEAN | DEFAULT 0 | Autoriser les commentaires |
| show_author_info | BOOLEAN | DEFAULT 0 | Afficher l'auteur |
| shared_at | DATETIME | NULL | Date de partage |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |
| updated_at | DATETIME | NULL | Date de modification |

### **PASSWORD_RESET**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| user_id | INT | FK, NOT NULL | ID de l'utilisateur |
| token | VARCHAR(255) | UNIQUE, NOT NULL | Token de reset |
| expires_at | DATETIME | NOT NULL | Date d'expiration |
| used | BOOLEAN | DEFAULT 0 | Token utilisÃ© |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |

### **EMAIL_VERIFICATION**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| user_id | INT | FK, NOT NULL | ID de l'utilisateur |
| token | VARCHAR(255) | UNIQUE, NOT NULL | Token de vÃ©rification |
| expires_at | DATETIME | NOT NULL | Date d'expiration |
| verified | BOOLEAN | DEFAULT 0 | Email vÃ©rifiÃ© |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |

### **USER_SESSIONS**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| user_id | INT | FK, NOT NULL | ID de l'utilisateur |
| token | VARCHAR(255) | UNIQUE, NOT NULL | Token de session |
| device_info | VARCHAR(255) | NULL | Info de l'appareil |
| ip_address | VARCHAR(45) | NULL | Adresse IP |
| expires_at | DATETIME | NOT NULL | Date d'expiration |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |
| last_activity | DATETIME | NULL | DerniÃ¨re activitÃ© |

### **RECIPE_VIEWS**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| recipe_id | INT | FK, NOT NULL | ID de la recette |
| user_id | INT | FK, NULL | ID de l'utilisateur |
| ip_address | VARCHAR(45) | NULL | Adresse IP |
| viewed_at | DATETIME | NOT NULL | Date de vue |

### **RECIPE_RATINGS**
| Attribut | Type | Contrainte | Description |
|----------|------|------------|-------------|
| id | INT | PK, AUTO | Identifiant unique |
| recipe_id | INT | FK, NOT NULL | ID de la recette |
| user_id | INT | FK, NOT NULL | ID de l'utilisateur |
| rating | INT | NOT NULL | Note (1-5) |
| review | TEXT | NULL | Avis |
| created_at | DATETIME | NOT NULL | Date de crÃ©ation |
| updated_at | DATETIME | NULL | Date de modification |

## ğŸ‰ RÃ‰SUMÃ‰ MCD COMPLET

**ENTITÃ‰S PRINCIPALES :**
- **USER** : Utilisateurs avec authentification complÃ¨te
- **RECIPE** : Recettes avec partage et commentaires
- **FAVORITE** : Favoris des utilisateurs
- **COMMENT** : Commentaires sur les recettes
- **FOLLOW** : Suivi entre utilisateurs
- **BADGE** : SystÃ¨me de rÃ©compenses

**ENTITÃ‰S D'AUTHENTIFICATION :**
- **PASSWORD_RESET** : Reset de mot de passe
- **EMAIL_VERIFICATION** : VÃ©rification d'email
- **USER_SESSIONS** : Sessions utilisateur

**ENTITÃ‰S D'ANALYTIQUE :**
- **RECIPE_VIEWS** : Vues des recettes
- **RECIPE_RATINGS** : Notes et avis

**RELATIONS PRINCIPALES :**
- User crÃ©e Recipe (1:N)
- User a des Favorites (1:N)
- Recipe a des Comments (1:N)
- User suit d'autres Users (N:N)
- User a des Badges (N:N)
- User a des Sessions (1:N)
- Recipe a des Views (1:N)
- Recipe a des Ratings (1:N)

Ce MCD complet inclut toute la gestion d'authentification et d'analytique ! ğŸ¯
